# 화면을 개발하기 위한 필수 단위 : 인스턴스 & 컴포넌트

## 03-1 뷰 인스턴스

### 뷰 인스턴스의 정의와 속성

뷰 인스턴스(instance)는 뷰로 화면을 개발하기 위해 필수적으로 생성해야 하는 기본 단위



#### 뷰 인스턴스 생성

```javascript
//뷰 인스턴스 형식
new Vue({
    // el 속성
    el : '#app'
    // data 속성
    data : {
    	message : 'Hello Vue,js!'
	}
});
```

'Hello Vue.js!' 텍스트를 화면에 표시하기 위해  ```new Vue()``` 로 뷰 인스턴스를 생성

인스턴스 안에 ```el``` 속성으로 뷰 인스턴스가 그려질 지점을 지정

```data``` 속성으로 message 값을 정의하여 화면의 ```{{message}}``` 에 연결



#### 뷰 인스턴스 생성자 

```new Vue()``` 로 인스턴스를 생성할 때 ```Vue```를 생성자라고 한다. 

뷰 생성자는 뷰 라이브러리를 로딩하고 나면 접근 가능하다. 

뷰로 개발할 때 필요한 기능들을 생성자에 미리 정의해 놓고 사용자가 그 기능을 저정의하여 편리하게 사용하도록 하기 위해서이다. 



### 뷰 인스턴스 옵션 속성

- 뷰 인스턴스 옵션 속성은 인스턴스를 생성할 때 재정의 할 data, el, template 등의 속성을 의미 
- 위에서는 data 라는 미리 정의되어 있는 속성을 사용

- el 속성 : 미리 정의 되어 있고 뷰로 만든 화면이 그려지는 시작점을 의미
  - 뷰 인스턴스로 화면을 렌더링할 때 화면이 그려질 위치의 돔 요소를 지정해 주어야 함 

```javascsript
<div id = "app">
	{{ message }}
</div>
```

``` javascript
new Vue({
    el : '#app',
    data : { message : 'Hello Vue.js!' }
});
```

```#app``` 값은 화면의 돔 요소 중 app이라는 아이디를 가진 요소를 의미한다. 

여기서 ```#``` 선택자는 css 선택자 규칙과 같다. 



이외에도 

| 속성     | 설명                                                         |
| -------- | ------------------------------------------------------------ |
| template | 화면에 표시할 HTML, CSS 등의 마크업 요소를 정의하는 속성, 뷰의 데이터 및 기타 속성들도 함께 화면에 그릴 수 있음 |
| methods  | 화면 로직 제어와 관계된 메서드를 제어하는 속성. 마우스 클릭 이벤트 처리와 같이 화면의 전반적인 이벤트와 화면 동작과 관련된 로직을 추가할 수 있음 |
| created  | 뷰 인스턴스가 생성되자마자 실행할 로직을 정의할 수 있는 속성. |



### 뷰 인스턴스의 유효 범위

#### 인스턴스의 유효 범위란?

뷰 인스턴스를 생성하면 HTML의 특정 범위 안에서만 옵션 속성들이 적용되어 나타남

인스턴스의 유효 범위는 el 속성과 밀접한 관계가 있음



```new Vue()``` 로  인스턴스를 생성하고 나서 화면에 인스턴스 옵션 속성을 적용하는 과정

- 뷰 라이브러리 파일 로딩
- 인스턴스 객체 생성
  - el, data 옵션 속성을 정의해주고 new Vue() 로 인스턴스 객체를 생성

- 특정 화면 요소에 인스턴스를 붙임
  - 브라우저에서 샘플 코드를 실행하면 el 속성에 지정한 화면 요소(돔)에 인스턴스가 부착된다. 
- 인스턴스 내용이 화면 요소로 변환
  - el 속성에 인스턴스가 부착되고 나면 인스턴스에 정의한 옵션의 내용(data속성) 이 el 속성에 지정한 화면 요소와 그 이하의 레벨의 화면 요소에 적용되어 값이 치환된다. 
- 변환된 화면 요소를 사용자가 최종 확인



#### 인스턴스의 유효범위 확인

``` 
<div id = "app">

</div>
{{ message }}
```

인스턴스의 유효범위는 id = "app"  이하의 하위 레벨이기 때문에 이 밖에 위치한 ``` {{ message }}``` 에는 영향을 끼치지 않는다. 



#### 뷰 인스턴스 라이프 사이클

- 라이프 사이클 : 모바일 앱을 비롯하여 일반적으로 애플리케이션이 가지는 생명 주기 

- 라이프 사이클 속성 : 인스턴스의 상태에 따라 호출할 수 있는 속성들 

- 라이프 사이클 훅 : 각 라이프 사이클 속성에서 실행되는 커스텀 로직

  - 커스텀 로직 : 개발자가 임의로 작성한 추가 로직

  

![img](https://t1.daumcdn.net/cfile/tistory/994C103B5A7878FE22) 

- 라이프 사이클 속성 종류 : 총 8개

  <인스턴스 생성>

  - beforeCreate
  - created
  - beforeMount
  - mounted

  <인스턴스를 화면에 부착>

  - beforeUpdate
  - updated

  <인스턴스 내용 갱신>

  - beforeDestroy
  - destroyed

  <인스턴스 소멸>



#####  beforeCreate

- 생성되고 나서 가장 처음으로 실행되는 라이프 사이클 단계
- data 속성과 methods속성이 아직 정의되지 않음
- 돔과 같은 화면 요소에도 접근 할 수 없음



##### created

- data methods 속성이 정의됨
- this. data 또는 this.fetchData() 와 같은 로직들을 이용하여 실행 가능
- 아직 인스턴스가 화면에 부착되기 전이기에 template 속성에 정의된 돔 요소로 접근할 수 없음
- data/methods 속성에 접근할 수 있는 가장 첫 라이프 사이클 단계이자 컴포넌트가 생성되고 나서 실행되는 단계이기 때문에 서버에 데이터를 요청하여 받아오는 로직을 수행하기 좋음. 



##### beforeMount

- created 단계 이후 template 속성에 지정한 마크업 속성을 render() 함수로 변환한 후 
- el속성에 지정한 화면 요소(돔)에 부착하기 전에 호출되는 단계
- render() 함수가 호출 되기 직전의 로직 추가하기가 좋음
  - render() : 자바스크립트로 화면의 돔을 그리는 함수



##### mounted 

- el 속성에서 지정한 화면 요소에 인스턴스가 부착되고 나면 호출되는 단계
- template 속성에 정의한 화면 요소(돔)에 접근할 수 있어 화면 요소를 제어하는 로직을 수행하기 좋은 단계.
- 돔에 인스턴스가 부착되자마자 바로 호출되기 떄문에 하위 컴포넌트나 외부 라이브러리에 의해 추가되 ㄴ화면 요소들이 최종 HTML코드로 변환되는 시점과는 다름. 
  - 변환되는 시점이 다를 경우 ```$next Tick()``` API를 활용하여 HTMl코드로 파싱(변환) 될 때까지 기다린 후 돔 제어 로직을 추가합니다. 



##### beforeUpdate

- el 속성에서 지정한 화면 요소에 인스턴스가 부착되고 나면 인스턴스에 정의한 속성들이 화면에 치환 됨.
- 치환된 값은 뷰의 반응성을 제공하기 위해 ```$watch``` 속성으로 감시함. ==> 데이터 관찰
  - 뷰의 반응성  : 뷰의 특징 중 하나로, 코드의 변화에 따라 화면이 반사적으로 반응하여 빠르게 화면을 갱신하는 것을 의미
- 관찰하고 있는 데이터가 변경되면 가상 돔으로 화면을 다시 그리기 전에 호출되는 단계
- 변경 예정인 새 데이터에 접근할 수 있음



##### updated 

- 데이터가 변경되고 나서 가상 돔으로 다시 화면을 그리고 나면 실행되는 단계 
- 데이터 변경으로 인한 환면 요소 변경까지 완료된 시점
- 데이터 변경 후 화면 요소 제어와 관련된 로직을 추가하기 좋음
- 여기서 데이터를 변경하면 무한루프에 빠질 수 있음...
  - computed/ watch와 같은 속성을 사용하자
  - 가급적이면beforeUpdate에 데이터 값을 갱신할 것
- 변경 데이터의 화면 요소와 관련된 로직을 추가합시다. 
- mounted 단계와 마찬가지로 하위 컴포넌트의 화면 요소와 외부 라이브러리에 의해 주입된 요소의 최종 변환 시점이 다를 수 있다. 
  - ```$nextTick()``` 을 사용하여 변환이 완료될 때까지 기다렸다가 로직을 추가합니다. 



##### beforeDestroy

- 뷰 인스턴스가 파괴되기 직전
- 아직은 인스턴스에 접근 할 수있음
- 뷰 인스턴스의 데이터를 삭제하기 좋음



##### destroyed

- 뷰인스턴스가 파괴도고 나서 호출되는 단계
- 뷰인스턴스에 정의한 모든 속성이 제거되고 하위에 선언한 인스턴스들 또한 모두 파괴됨



``` index.html
<html>
  <head>
    <title>Vue Instance Lifecycle</title>
  </head>
  <body>
    <div id = "app">
      {{message}}
    </div>

    <script src = "http://cdn.jsdelivr.net/npm/vue@2.5.2/dist/vue.js"></script>
    <script>
      new Vue({
        el : '#app',
        data : {
          message : "hello Vue.js!"
        },
        beforeCreate : function() {
          console.log("beforeCreate");
        },
        created : function(){
          console.log("created");
        },
        mounted : function() {
          console.log("mounted");
        },
        updated : function() {
          console.log("updated");
        }
      });
    </script>
  </body>
</html>

```

![1533577953471](C:\Users\YOONHOI\AppData\Local\Temp\1533577953471.png)



beforeCreate, created, mounted가 표시되었다. 

다만 updated는 호출되지 않았음을 알 수 있다. 







