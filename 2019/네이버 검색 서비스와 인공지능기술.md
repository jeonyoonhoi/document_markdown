# 네이버 검색 서비스와 인공지능기술

NAVER 통합검색연구개발부 김상범 박사 특강 

2018-11-30





##  전 세계 의미있는 검색서비스 7개 

##### GOOGLE

- 대부분의 나라에서 압도적인 점유율 차지.



##### BING

- 미국에서 20%정도

- MS사가 Google을 견제하기 위해 드러낸 것

- 구글이 bing이 자신의 검색결과를 치팅한다는 주장

  bing 입장 : 인터넷 익스플로러 -> 구글접속 -> 이러한 데이터를 기반으로 서치엔징

  혹시 Chrome을 열심히 만든게 이것 때문이 아닌지ㅣ... ㅇㅅㅇ



##### Yahoo

- 현재 우리나라에서는 철수
- google + bing 의 서치엔진 사용



##### Baidu 

- 중국 점유율 1위 (like 우리나라의 NAVER)



##### Yandex

- 러시아 점유율 1위



##### Seznam

- 체코의 언론사에서 시작, 뉴스 검색을 시작으로!
- 어느정도의 의미있는 사업이지만 구글이 넘어감



##### NAVER



## 웹 검색이 뉴스검색, 블로그검색과 다른 점

- 검색 대상의 양과 위치 : 뉴스는 어느정도 대략 알 수 있음
- 검색 컨텐츠의 품질 : 일정부분 관리 가능



>  웹 검색이 좀 더 의미를 정확히 파악해서 정확한 결과를 내줘야 한다. 
>
> 단어 자체가 들어가는 것 보다 그 단어의 정보를 파악해서 제공하는 것이 중요
>
> Ex ) 롯데타워 전망대 가격 ==> Seoul Sky 홈페이지 에서 제공하는 가격표 등의 정보를 제공해야 함
>
> 수집엔지니어, 데이터 엔지니어 등등





## 검색 서비스를 개발하는 과정

- 먼저 가이드라인에 따른 기계학습용 학습데이터를 구축

  > training set을 만들어내야하는데 "가이드라인"을 구축하는 것, 이것에 대한 논의와 기준을 만드는 것
  >
  > 여기서 하는 일은 알고리즘 자체를 개발하는 일이 아니라
  >
  > 이미 만들어져 있는 알고리즘을 어떻게 적용하여 어떻게 좋은 결과물을 낼 것인가- 가 중요. 

  training set 필요하다. 

  (1) 네이버가 지향하는 좋은 검색결과에 대한 논의 

  (2) 검색평가 가이드라인

  (3) 가이드라인에 따른 평가

  (4) 학습용 데이터 집합


- 기계학습알고리즘을 이용하여 검색랭킹모듈을 학습

  (5) 엔지니어들의 시그널 발굴

  ​	명확한 raw data (사진이면 픽셀, 이미지면 voice, 등등)

  ​	딥러닝이 되면서 raw data + 딥러닝의 조합이 정확도가 높어져서 

  ​	feature 를 뽑아내는 일의 중요성이적어졌다. 

  ​	문제는 "검색" 은 명확한 raw data가 없다는 것. 

   	즉 feature engineering이 중요해졌다. 

  > 즉, 결국, 사람의IDEA 가 중요하구나 - . 시작은 

  EX)

  - 질의가 제목에 매치된 빈도
  - 제목 전체에서 질의와 매치된 비율
  - 질의가 본문에매치된 빈도
  - 질의내 단어별 본문매치빈도의 분산
  - 해당 사이트의 신뢰도
  - 해당도메인의 남은유효기간



  (6) 뉴스검색학습용 데이터 집합을 기반으로 실험데이터생성 및 기계학습  실행

  => 그리고 모델을 평가하는 것, feature를 잘 뽑았냐에 대한 것들도



## 랭킹 모듈을 "학습" 한다 

#### 검색랭킹 기계학습을 구성하는 두 파트

- 벡터로 만들어진 검색랭킹용 학습데이터

- number of title matched words in user query/ number of words in user query

- number of title matched words in user query/ number of words in title

  - 이 둘만 랭킹 시그널 (비밀유지.. 왜냐면 어뷰징)

    만약 1번만 되면 포스트의 제목이 엄청엄청 길어짐 



##### 랭킹 시그널의 비밀

ㅋㅋㅋ그래서 SEO Business 가 발전한다. 

밖에서 실험해서 결과가 나온다는 것,,, 



## 랭킹 성능을 "평가"

- 이상적인 랭킹
- 랭킹 평가의 중요요소는
  - 상위 요소의 정확도가 중요하다는 것!
  - 훨씬 크리티컬! : 상위 앞단이 틀린 것>>>>> 하위 뒷 결과가 틀린 것 : 
- Yahoo 에서 주관한 Learning to rank challenge



## Matching and ranking

- Matching 매칭 : 검색어와 관련된 정보의 풀을 정하는 것

- Ranking 랭킹 :  풀 안에서 순위를 정하는 것



#### Matching 

- 사용자가 입력한 질의와 관련이 있는 문서를 일단 모두 추려내는 일로, 색인(indexing)에 의해 가능 
- 색인의 개념이 없을 때는 문서에 카테고리 코드를 부착하는 식으로 관리되었다. 
- 색인은 등장 당시 무지 혁신적이였지만 지금은 너무나 당연한 검색 방법으로 자리잡았다. 



- 현재까지는 단어 기반 매칭이 주류
- 단어기반 매치은 형태론적 분석, 동의어처리가 도전과제

- 질의오류교정 



#### Semantic Matching

이용요금 = 가격

- Document Expansion
  - QueryText = 사용자가 문서를 클릭했을 때 이용한 쿼리

    동일한 검색어를 입력한 사용자가 많이 조회한 웹과 문서를 매칭한다. 

    이때 문서에서 '이용요금' 과 '가격' 이라는 동시에 등장하면

    각 검색 결과에서 사용자가 접근한 소스에는 검색어로 태깅을 한다. 

  - 클릭한 데이터를 기반으로 맞았는지 틀렸는지 판단! 
  - 인사이트를 적용할 수 있는 방법을 논문에서 찾는다. 
  - Word2vec :  두 단어가 의미적으로 비슷한 단어를 찾을 때 두 단어와 같이 나오는 구성/단어들이 비슷하다면? 그 두 단어는 의미론적으로 비슷하다는 인사이트에서 나온 뉴럴넷! 
  - node2vec
  - 현실에 대한 문제를 풀기 위한 아이디어 ==> 이와 관련된 논문을 검색 ==> 파라미터 조정, 커스터마이즈
  - 단점 :  클릭이 어느정도 존재해야 가능하다는 문제가 존재한다. 
  - 자동번역기법을 응용해보자. 

- >  뭔가,, 엄청,,,idea 싸움,,,, insight의 중요,,,,

- 왜 딥러닝기반의 번역이 떴을까?

  기존 기계학습 방식으로 하면 유연성이 없음. 

  롯데월드 에버랜드 에코랜드 대구이랜드 / 이용요금 입장료

  렌터카 파리지하철 한강유람선 /이용요금 이용료

  각 단어들의 공통점과 차이점을 알아내야 한다. 

  렌터카 입장료??? 는 이상하잖아!

  * 기계학습은 각 단어들의 카테고리의 그 유사성을 알 수 있음ㅇ



#### Ranking

- old approaches
- 실제로 서비스가 되기 시작하면서 모델 말고도 사용할 데이터가 폭발적!



검색은 전형적인 기계학습문제 아닌가욤!

- 실제로 좋은 검색결과를 만들기 위해 많은 시그널(피쳐)을 사용

- (노이즈가 있지만) 비교적 대규모의 학습집합을 구축하게 됨

  클릭 여부와 그 위치(랭크)



- Ranking SVM



> 지금의 인공지능 기술 아가들이 잘 하는 것을 할 수 있는 것이 아닌가!
>
> 사실상 검색은 좀더 의미론적인거라 딥러닝을 적용하기가 힘들다. 



아직까지는 검색은 좋은 feature engineering을 필요로 한다. 

다만 적용을 굳이 하자면 딥러닝을 이용해서 feature engineering을 하는 것!